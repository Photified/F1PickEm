<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F1 2026: CHAMPIONSHIP BINGO</title>
    <link href="https://fonts.googleapis.com/css2?family=Titillium+Web:ital,wght@0,400;0,600;0,700;0,900;1,400&display=swap" rel="stylesheet">
    <style>
        :root {
            --f1-red: #e10600;
            --f1-dark: #15151e;
            --bg-body: #f4f4f8;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.08);
            
            /* Scoring Colors */
            --score-tile: #e10600;
            --score-line: #00d2be;
            --score-bingo: #ffb800;
            
            /* Category Colors */
            --c-driver: #ff9500; 
            --c-team: #00d2be;   
            --c-tech: #2962ff;   
            --c-chaos: #d50000;  
        }

        body {
            font-family: 'Titillium Web', sans-serif;
            background: var(--bg-body);
            color: var(--f1-dark);
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- HEADER & NAV --- */
        header {
            background: white;
            border-bottom: 4px solid var(--f1-red);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            z-index: 20;
        }

        .header-title {
            font-size: 24px;
            font-weight: 900;
            font-style: italic;
            text-transform: uppercase;
        }

        .header-controls { display: flex; gap: 10px; }

        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            font-weight: 700;
            font-size: 13px;
            cursor: pointer;
            text-transform: uppercase;
        }

        .btn-score { background: var(--f1-dark); color: white; }
        .btn-score:hover { background: #333; }
        
        /* --- RACE BAR --- */
        .race-bar {
            background: #fff;
            padding: 10px 20px;
            display: flex;
            gap: 15px;
            overflow-x: auto;
            border-bottom: 1px solid #ddd;
            scrollbar-width: thin;
        }

        .race-item {
            flex: 0 0 auto;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 5px 12px;
            border-radius: 20px;
            background: #f0f0f0;
            opacity: 0.5;
            cursor: default;
            font-weight: 700;
            font-size: 12px;
        }

        .race-item.active {
            opacity: 1;
            background: var(--f1-red);
            color: white;
            box-shadow: 0 4px 8px rgba(225, 6, 0, 0.3);
        }

        .race-item.past {
            opacity: 0.7;
            background: #333;
            color: white;
        }

        /* --- MAIN LAYOUT --- */
        .main-stage {
            flex: 1;
            display: flex;
            padding: 20px;
            gap: 20px;
            overflow: hidden;
        }

        /* --- SIDEBAR (Leaderboard & Pool) --- */
        .sidebar {
            width: 350px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .panel {
            background: white;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            padding: 12px;
            background: #f9f9f9;
            font-weight: 800;
            font-size: 14px;
            text-transform: uppercase;
            border-bottom: 1px solid #eee;
            text-align: center;
        }

        /* LEADERBOARD */
        .leaderboard-list {
            padding: 0;
            margin: 0;
            list-style: none;
            overflow-y: auto;
            max-height: 200px;
        }

        .lb-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 15px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 13px;
        }
        .lb-row:nth-child(1) { background: rgba(255, 184, 0, 0.1); font-weight: bold; border-left: 4px solid #ffb800; }
        .lb-row:nth-child(2) { border-left: 4px solid #c0c0c0; }
        .lb-row:nth-child(3) { border-left: 4px solid #cd7f32; }

        /* POOL */
        .pool-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .pool-item {
            padding: 8px 12px;
            margin-bottom: 6px;
            background: white;
            border: 1px solid #eee;
            border-left: 4px solid #555;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            cursor: grab;
        }
        .pool-item.driver { border-left-color: var(--c-driver); }
        .pool-item.team { border-left-color: var(--c-team); }
        .pool-item.tech { border-left-color: var(--c-tech); }
        .pool-item.chaos { border-left-color: var(--c-chaos); }

        /* --- GAME GRID --- */
        .grid-container {
            flex: 1;
            background: white;
            border-radius: 10px;
            box-shadow: var(--card-shadow);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .bingo-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            width: 100%;
            max-width: 650px;
            aspect-ratio: 1/1;
        }

        .slot {
            background: #f8f8f8;
            border: 2px dashed #e0e0e0;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 4px;
            font-size: 11px;
            font-weight: 700;
            position: relative;
        }

        .slot.filled {
            border: none;
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
        }
        
        .slot[data-type="driver"].filled { background: var(--c-driver); }
        .slot[data-type="team"].filled { background: var(--c-team); }
        .slot[data-type="tech"].filled { background: var(--c-tech); }
        .slot[data-type="chaos"].filled { background: var(--c-chaos); }
        .slot.free { background: #111; color: var(--f1-red); font-size: 14px; text-transform: uppercase; border:none; }

        /* SCORING HIGHLIGHTS */
        .slot.correct { 
            opacity: 1; 
            box-shadow: inset 0 0 0 3px #fff, 0 0 15px var(--score-tile); 
        }
        .slot.correct::after {
            content: '‚úì'; position: absolute; top: -5px; right: -5px;
            background: white; color: var(--score-tile);
            border-radius: 50%; width: 16px; height: 16px; font-size: 12px;
            display: flex; align-items: center; justify-content: center;
        }

        /* --- MODAL --- */
        .modal {
            display: none;
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 100;
            align-items: center; justify-content: center;
        }
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            position: relative;
        }
        .close-btn { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; }

        .score-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #eee; }
        .score-val { font-weight: 900; color: var(--f1-red); }

        /* --- ADMIN TEST PANEL (Bottom) --- */
        .admin-panel {
            background: #222; color: white; padding: 10px; font-size: 12px;
            display: flex; gap: 10px; align-items: center;
        }
        .admin-input { padding: 5px; background: #333; border: 1px solid #555; color: white; width: 300px; }

    </style>
</head>
<body>

<header>
    <div class="header-title">F1 <span style="color:var(--f1-red)">2026</span> BINGO</div>
    <div class="header-controls">
        <button class="btn btn-score" onclick="openModal()">Scoring Rules</button>
        <button class="btn" style="background:#e0e0e0" onclick="reset()">Reset</button>
    </div>
</header>

<div class="race-bar">
    <div class="race-item active">üá¶üá∫ Melbourne</div>
    <div class="race-item">üá®üá≥ Shanghai</div>
    <div class="race-item">üáØüáµ Suzuka</div>
    <div class="race-item">üáßüá≠ Sakhir</div>
    <div class="race-item">üá™üá∏ Madrid</div>
</div>

<div class="main-stage">
    
    <div class="sidebar">
        <div class="panel" style="flex:0 0 auto; height: 200px;">
            <div class="panel-header">üèÜ Championship Standings</div>
            <ul class="leaderboard-list" id="leaderboard">
                </ul>
        </div>

        <div class="panel" style="flex:1;">
            <div class="panel-header">Prediction Pool</div>
            
            <div style="display:flex; padding:5px; gap:5px; background:#f0f0f0;">
                <button class="btn" style="flex:1; font-size:10px; background:#fff;" onclick="filterPool('driver')">Drivers</button>
                <button class="btn" style="flex:1; font-size:10px; background:#fff;" onclick="filterPool('team')">Teams</button>
                <button class="btn" style="flex:1; font-size:10px; background:#fff;" onclick="filterPool('tech')">Tech</button>
                <button class="btn" style="flex:1; font-size:10px; background:#fff;" onclick="filterPool('chaos')">Chaos</button>
            </div>

            <div id="pool" class="pool-list"></div>
        </div>
    </div>

    <div class="grid-container">
        <div class="bingo-grid" id="grid"></div>
    </div>
</div>

<div id="scoreModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <h2 style="margin-top:0; color:var(--f1-red)">OFFICIAL SCORING</h2>
        <p style="font-size:12px; color:#666;">Points are awarded after the race based on verified results.</p>
        
        <div class="score-row">
            <span>‚úÖ Single Correct Tile</span>
            <span class="score-val">+10 pts</span>
        </div>
        <div class="score-row">
            <span>‚ûñ Horizontal Line</span>
            <span class="score-val">+50 pts</span>
        </div>
        <div class="score-row">
            <span>‚¨áÔ∏è Vertical Line</span>
            <span class="score-val">+50 pts</span>
        </div>
        <div class="score-row">
            <span>‚ùå Diagonal Line</span>
            <span class="score-val">+75 pts</span>
        </div>
        <div class="score-row">
            <span>üî≤ 4 Corners (Outer)</span>
            <span class="score-val">+100 pts</span>
        </div>
        <div class="score-row">
            <span>üî† Letter 'H' Pattern</span>
            <span class="score-val">+150 pts</span>
        </div>
        <div class="score-row">
            <span>üî† Letter 'T' Pattern</span>
            <span class="score-val">+150 pts</span>
        </div>
    </div>
</div>

<div class="admin-panel">
    <strong>üë®‚Äçüíª ADMIN:</strong>
    <input type="text" id="adminResults" class="admin-input" placeholder="Enter comma-separated events (e.g., Norris Win, Lap 1 Safety Car)">
    <button class="btn" style="background:var(--f1-red); color:white" onclick="adminSubmitResults()">Verify & Score</button>
</div>

<script>
    // --- 1. DATA SOURCES ---
    // In a real app, this comes from a database
    const poolData = {
        driver: ["Norris Win", "Verstappen Pole", "Hamilton Podium", "Antonelli Top 5", "Leclerc DNF", "Piastri Fastest Lap", "Alonso Radio Rant"],
        team: ["McLaren 1-2", "Red Bull Slow Stop", "Ferrari Strategy Fail", "Williams Double Q3", "Audi DNF", "Mercedes Double Points"],
        tech: ["Manual Override Pass", "Active Aero Stuck", "MGU-K Issue", "Underweight Car", "Front Wing Dmg"],
        chaos: ["Lap 1 Safety Car", "Red Flag", "Rain", "Turn 1 Pile-up", "5s Penalty", "VSC"]
    };

    // Simulated Leaderboard Data
    let leaderboardData = [
        { name: "You (Team Principal)", score: 0, grid: [] }, // This is the user
        { name: "Toto Wolff", score: 120, grid: [] },
        { name: "Christian Horner", score: 85, grid: [] },
        { name: "Fred Vasseur", score: 40, grid: [] }
    ];

    let myGrid = Array(25).fill(null);
    let currentCat = 'driver';

    // --- 2. INIT ---
    function init() {
        createGrid();
        filterPool('driver');
        updateLeaderboard();
    }

    // --- 3. GRID & DRAG LOGIC ---
    function createGrid() {
        const grid = document.getElementById('grid');
        grid.innerHTML = '';
        
        for(let i=0; i<25; i++) {
            const slot = document.createElement('div');
            
            if(i===12) {
                slot.className = 'slot free';
                slot.innerText = "LIGHTS OUT";
                // Free space is effectively "filled" for logic
                myGrid[i] = "FREE"; 
            } else {
                slot.className = 'slot';
                slot.ondragover = e => e.preventDefault();
                slot.ondrop = e => handleDrop(e, i);
                slot.onclick = () => removeTile(i);
            }
            
            // Re-render if state exists
            if(myGrid[i] && i !== 12) {
                slot.classList.add('filled');
                slot.innerText = myGrid[i].text;
                slot.dataset.type = myGrid[i].type;
            }

            grid.appendChild(slot);
        }
    }

    function filterPool(cat) {
        const pool = document.getElementById('pool');
        pool.innerHTML = '';
        currentCat = cat;
        
        poolData[cat].forEach(text => {
            const el = document.createElement('div');
            el.className = `pool-item ${cat}`;
            el.innerText = text;
            el.draggable = true;
            el.ondragstart = e => {
                e.dataTransfer.setData('text', text);
                e.dataTransfer.setData('type', cat);
            };
            pool.appendChild(el);
        });
    }

    function handleDrop(e, index) {
        e.preventDefault();
        const text = e.dataTransfer.getData('text');
        const type = e.dataTransfer.getData('type');
        
        myGrid[index] = { text, type };
        createGrid(); // Re-render
    }

    function removeTile(index) {
        myGrid[index] = null;
        createGrid();
    }

    // --- 4. SCORING ENGINE (The Logic you asked for) ---
    function calculateScore(grid, verifiedEvents) {
        let score = 0;
        let matches = []; // indices of correct tiles

        // 1. Check Individual Tiles
        grid.forEach((item, index) => {
            if(index === 12) { matches.push(12); return; } // Free space always matches
            if(item && verifiedEvents.includes(item.text)) {
                score += 10;
                matches.push(index);
            }
        });

        // 2. Check Lines (50pts)
        // Rows
        for(let r=0; r<5; r++) {
            if([0,1,2,3,4].every(o => matches.includes(r*5 + o))) score += 50;
        }
        // Cols
        for(let c=0; c<5; c++) {
            if([0,1,2,3,4].every(o => matches.includes(o*5 + c))) score += 50;
        }

        // 3. Diagonals (X) (75pts)
        const diag1 = [0,6,12,18,24];
        const diag2 = [4,8,12,16,20];
        if(diag1.every(i => matches.includes(i))) score += 75;
        if(diag2.every(i => matches.includes(i))) score += 75;

        // 4. Four Corners (100pts)
        const corners = [0,4,20,24];
        if(corners.every(i => matches.includes(i))) score += 100;

        // 5. Letter T (Row 0 + Col 2) (150pts)
        const letterT = [0,1,2,3,4, 7,12,17,22]; // Top row + Middle Col
        if(letterT.every(i => matches.includes(i))) score += 150;

        // 6. Letter H (Col 0 + Col 4 + Row 2) (150pts)
        const letterH = [0,5,10,15,20, 4,9,14,19,24, 11,12,13];
        if(letterH.every(i => matches.includes(i))) score += 150;

        return { score, matches };
    }

    // --- 5. ADMIN / SERVER SIMULATION ---
    function adminSubmitResults() {
        const input = document.getElementById('adminResults').value;
        const events = input.split(',').map(s => s.trim());

        // Calculate User Score
        const result = calculateScore(myGrid, events);
        
        // Update User in Leaderboard Array
        leaderboardData[0].score = result.score;
        
        // Visualize Correct Tiles on Board
        const slots = document.querySelectorAll('.slot');
        slots.forEach((s, i) => {
            s.classList.remove('correct');
            if(result.matches.includes(i) && i !== 12) s.classList.add('correct');
        });

        // Randomize CPU scores for fun
        leaderboardData[1].score += Math.floor(Math.random()*50);
        leaderboardData[2].score += Math.floor(Math.random()*50);
        leaderboardData[3].score += Math.floor(Math.random()*50);

        // Sort and Update UI
        leaderboardData.sort((a,b) => b.score - a.score);
        updateLeaderboard();
        alert(`Scoring Complete! You scored ${result.score} points.`);
    }

    function updateLeaderboard() {
        const list = document.getElementById('leaderboard');
        list.innerHTML = '';
        leaderboardData.forEach((p, i) => {
            const li = document.createElement('li');
            li.className = 'lb-row';
            li.innerHTML = `
                <span>#${i+1} ${p.name}</span>
                <span style="font-weight:900">${p.score} pts</span>
            `;
            list.appendChild(li);
        });
    }

    // --- 6. MODAL UTILS ---
    function openModal() { document.getElementById('scoreModal').style.display = 'flex'; }
    function closeModal() { document.getElementById('scoreModal').style.display = 'none'; }
    function reset() { location.reload(); }

    window.onload = init;

</script>

</body>
</html>